System.register(["angular2/core"],function(a){"use strict";var b,c,d,e,f=this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=3>f?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(3>f?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g},g=this&&this.__metadata||function(a,b){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(a,b):void 0};return{setters:[function(a){b=a}],execute:function(){c=function(){function a(a,b){this.utils=new d,this.dbWrapper=new e(a,b)}return a.prototype.createStore=function(a,b){var c=this,d=this,e=new Promise(function(e,f){c.dbWrapper.dbVersion=a;var g=c.utils.indexedDB.open(c.dbWrapper.dbName,a);g.onsuccess=function(a){d.dbWrapper.db=g.result,e()},g.onerror=function(a){f("IndexedDB error: "+a.target.errorCode)},g.onupgradeneeded=function(a){b(a,d.dbWrapper.db)}});return e},a.prototype.getByKey=function(a,b){var c=this,d=new Promise(function(d,e){c.dbWrapper.db||e("You need to use the createStore function to create a database before you query it!"),c.dbWrapper.validateStoreName(a)||e("objectStore does not exists: "+a);var f,g,h=c.dbWrapper.createTransaction({storeName:a,dbMode:c.utils.dbMode.readonly,error:function(a){e(a)},complete:function(a){d(f)}}),i=h.objectStore(a);g=i.get(b),g.onsuccess=function(a){f=a.target.result}});return d},a.prototype.getAll=function(a){var b=this,c=new Promise(function(c,d){b.dbWrapper.db||d("You need to use the createStore function to create a database before you query it!"),b.dbWrapper.validateStoreName(a)||d("objectStore does not exists: "+a);var e=b.dbWrapper.createTransaction({storeName:a,dbMode:b.utils.dbMode.readonly,error:function(a){d(a)},complete:function(a){c(g)}}),f=e.objectStore(a),g=[],h=f.openCursor();h.onerror=function(a){d(a)},h.onsuccess=function(a){var b=a.target.result;b&&(g.push(b.value),b["continue"]())}});return c},a.prototype.add=function(a,b,c){var d=this,e=new Promise(function(e,f){d.dbWrapper.db||f("You need to use the createStore function to create a database before you query it!"),d.dbWrapper.validateStoreName(a)||f("objectStore does not exists: "+a);var g=d.dbWrapper.createTransaction({storeName:a,dbMode:d.utils.dbMode.readwrite,error:function(a){f(a)},complete:function(a){e({key:b,value:c})}}),h=g.objectStore(a);h.add(c,b)});return e},a.prototype.update=function(a,b){var c=this,d=new Promise(function(d,e){c.dbWrapper.db||e("You need to use the createStore function to create a database before you query it!"),c.dbWrapper.validateStoreName(a)||e("objectStore does not exists: "+a);var f=c.dbWrapper.createTransaction({storeName:a,dbMode:c.utils.dbMode.readwrite,error:function(a){e(a)},complete:function(a){d(b)},abort:function(a){e(a)}}),g=f.objectStore(a);g.put(b)});return d},a.prototype["delete"]=function(a,b){var c=this,d=new Promise(function(d,e){c.dbWrapper.db||e("You need to use the createStore function to create a database before you query it!"),c.dbWrapper.validateStoreName(a)||e("objectStore does not exists: "+a);var f=c.dbWrapper.createTransaction({storeName:a,dbMode:c.utils.dbMode.readwrite,error:function(a){e(a)},complete:function(a){d()},abort:function(a){e(a)}}),g=f.objectStore(a);g["delete"](b)});return d},a.prototype.openCursor=function(a,b){var c=this,d=new Promise(function(d,e){c.dbWrapper.db||e("You need to use the createStore function to create a database before you query it!"),c.dbWrapper.validateStoreName(a)||e("objectStore does not exists: "+a);var f=c.dbWrapper.createTransaction({storeName:a,dbMode:c.utils.dbMode.readonly,error:function(a){e(a)},complete:function(a){d()},abort:function(a){e(a)}}),g=f.objectStore(a),h=g.openCursor();h.onsuccess=function(a){b(a),d()}});return d},a=f([b.Injectable(),g("design:paramtypes",[Object,Object])],a)}(),a("AngularIndexedDB",c),d=function(){function a(){this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.dbMode={readonly:"readonly",readwrite:"readwrite"}}return a}(),e=function(){function a(a,b){this.validateStoreName=function(a){return this.db.objectStoreNames.contains(a)},this.dbName=a,this.dbVersion=b||1,this.db=null,this.storeNames=[]}return a.prototype.createTransaction=function(a){var b=this.db.transaction(a.storeName,a.dbMode);return b.onerror=a.error,b.oncomplete=a.complete,b.onabort=a.abort,b},a}()}}});
//# sourceMappingURL=angular2-indexeddb.min.js.map